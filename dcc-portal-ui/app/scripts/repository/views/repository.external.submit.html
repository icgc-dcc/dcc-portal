<div class="modal-content download-manifests">
    <div class="modal-header clearfix">
      <h3 class="pull-left">Download manifests</h3>
      <button class="pull-right t_button" data-ng-click="cancel()"><i
              class="icon-cancel"></i>
      </button>
    </div>

    <div class="modal-body">
      <div class="modal-info-wrapper">
        <img class="modal-info-figure" src="/styles/images/checklist.svg" />
        <div class="modal-info">
          <p>A manifest is a text file passed to download clients in order to download selected files of interest. Each repository's manifest file can be individually downloaded.
          </p>
          <p>When choosing "Download All", a manifest containing unique files from all repositories will be generated. Some files may be stored in multiple repositories. Duplicates from repositories lower in the list will not be included. You may drag to reorder the list to affect the generated manifest.
          </p>
          <p>
          The available repositories below are restricted by your search filter:
          </p>
        </div>
      </div>

       <table class="table table-info">
         <thead>
           <th class="text-center" colspan="2">Priority</th>
           <th style="width: 40%;">Repository</th>
           <th class="text-right"># Donors</th>
           <th class="text-right"># Files</th>
           <th class="text-right">Total file size</th>
         </thead>

         <tbody dnd-list="repos">
            <tr
              data-ng-repeat-start="repoData in repos"
              data-ng-class="{
                alt: $index % 2 === 0
              }"
              dnd-moved="movedCallback($index)"
              dnd-draggable="repoData"
              dnd-dragstart="closeDropdowns()"
              dnd-effect-allowed="move"
            >
             <td class="handle text-right ">&nbsp;::: </td>
             <td class="text-left">{{$index + 1}}</td>
             <td>
                <i ng-if="repoData.isCloud" class="icon-cloud"></i>
                {{ repoData.repoName }}
             </td>
             <td class="text-right">
                <number-tween
                  ng-if="summary[repoData.repoName].donorCount !== undefined"
                  value="summary[repoData.repoName].donorCount"
                  formatter="$filter('number')"
                  on-tween-start="handleNumberTweenStart"
                  on-tween-end="handleNumberTweenEnd"
                ></number-tween>
            </td>
             <td class="text-right">
               <number-tween
                  ng-if="summary[repoData.repoName].fileCount !== undefined"
                  value="summary[repoData.repoName].fileCount"
                  formatter="$filter('number')"
                  on-tween-start="handleNumberTweenStart"
                  on-tween-end="handleNumberTweenEnd"
                ></number-tween>
            </td>
             <td class="text-right">
               <number-tween
                  ng-if="summary[repoData.repoName].fileSize !== undefined"
                  value="summary[repoData.repoName].fileSize"
                  formatter="$filter('bytes')"
                  on-tween-start="handleNumberTweenStart"
                  on-tween-end="handleNumberTweenEnd"
                ></number-tween>
            </td>
           </tr>

            <tr class="extras" data-ng-repeat-end data-ng-if="
              repoData.isGeneratingManifestID ||
              repoData.isGeneratingManifestShortUrl ||
              repoData.manifestID ||
              repoData.shortUrl"
            >
              <td colspan="6" class="text-right">
                <div class="spinner-container" data-ng-if="repoData.isGeneratingManifestShortUrl || repoData.isGeneratingManifestID">
                  <i class="icon-spinner icon-spin"></i>
                </div>

                <div class="container-fluid">

                  <div class="row" data-ng-if="repoData.shortUrl">
                    <div class="col-sm-3">
                      Manifest URL
                    </div>
                    <div class="col-sm-9 text-left">
                      <input
                        onClick="this.select()"
                        size="18"
                        type="text"
                        value="{{repoData.shortUrl}}"
                      />
                      <span
                          class="clip-icon"
                          style="cursor: pointer;"
                          data-copy-to-clip
                          data-copy-data="repoData.shortUrl"
                          data-show-copy-tips="true"
                          data-prompt-on-copy="false"
                          data-on-copy-success-message="Copied!"
                          data-on-hover-message="Copy to clipboard"
                        >
                          <span class="icon-clippy"></span>
                      </span>
                    </div>
                  </div>

                  <div class="row" data-ng-if-start="repoData.manifestID">
                    <div class="col-sm-3">
                      Manifest ID
                    </div>
                    <div class="col-sm-9 text-left">
                      
                      <div class="manifest" data-ng-if="repoData.hasManifest">
                        <input
                          onClick="this.select()"
                          size="38"
                          type="text"
                          value="{{repoData.manifestID}}"
                        />
                        <span
                          class="clip-icon"
                          style="cursor: pointer;"
                          data-copy-to-clip
                          data-copy-data="repoData.manifestID"
                          data-show-copy-tips="true"
                          data-prompt-on-copy="false"
                          data-on-copy-success-message="Copied!"
                          data-on-hover-message="Copy to clipboard"
                        >
                          <span class="icon-clippy"></span>
                        </span>
                      </div>
                    </div>
                  </div>

                  <div class="row" data-ng-if-end>
                    <div class="col-sm-3">
                      Usage example
                    </div>
                    <div class="col-sm-9 text-left">
                      <input
                        onClick="this.select()"
                        class="code"
                        size="76"
                        type="text"
                        value="{{ 'bin/icgc-storage-client manifest --manifest ' + repoData.manifestID }}"
                      />
                      <span
                        class="clip-icon"
                        style="cursor: pointer;"
                        data-copy-to-clip
                        data-copy-data="'bin/icgc-storage-client manifest --manifest ' + repoData.manifestID"
                        data-show-copy-tips="true"
                        data-prompt-on-copy="false"
                        data-on-copy-success-message="Copied!"
                        data-on-hover-message="Copy to clipboard"
                      >
                        <span class="icon-clippy"></span>
                      </span>
                    </div>
                  </div>

                </div>

             </td>
           </tr>

           <tr class="dndPlaceholder">
             <td colspan="7"></td>
           </tr>

         </tbody>
         <tfoot>
           <tr class="totals" style="font-weight: bold;">
             <td colspan="4" class="text-right">Totals:</td>
             <td class="text-right">{{ summary | _:'map':'fileCount' | _:'compact' | _:'sum' | number }}</td>
             <td class="text-right">{{ summary | _:'map':'fileSize' | _:'compact' | _:'sum' | bytes }}</td>
           </tr>
         </tfoot>
       </table>
    </div>

    <div class="modal-footer">
      <button class="t_button" data-ng-click="cancel();">Cancel</button>
      <button class="t_button" data-ng-click="download()"><i class="icon-download"></i>Download</button>
      <button
        class="t_button"
        data-ng-repeat="repoData in repos"
        data-ng-if="repos.length === 1 && repoData.hasManifest"
        data-ng-disabled="repoData.manifestID || repoData.isGeneratingManifestID"
        data-ng-click="(!repoData.manifestID && !repoData.isGeneratingManifestID) && createManifestId(repoData.repoName, repoData)"
      >
        Manifest ID
      </button>
    </div>
</div>
